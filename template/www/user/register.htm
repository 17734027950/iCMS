<!DOCTYPE html>
<html>

<head>
    <title>
        <!--{if $user}-->欢迎加入
        <!--{else}-->新用户注册
        <!--{/if}-->
        <!--{$site.title}-->
    </title>
    <meta name="keywords" content="<!--{$site.keywords}-->" />
    <meta name="description" content="<!--{$site.description}-->" />
    <meta name="mobile-agent" content="format=html5;url=<!--{$site.url}-->" />
    <!--{iCMS:public:ui}-->
    <link rel="stylesheet" href="<!--{$site.urls.tpl}-->/static/css/passport.css" type="text/css" />
    <script>
    $(function() {
        var register = $("#register-box");

        $("input[name=agreement]").click(function() {
          $(this).prop("checked", true);
        });

        $("#register_submit").click(function(event) {
            event.preventDefault();
            var checkform,param=[];
            $("input", register).each(function() {
                // check_form(this);
                //console.log(this.id, this.name, !$(this).data('check'))
                // if (!$(this).data('check')) {
                //     checkform = true;
                //     return false;
                // }
                //console.log(this.id, 'ok')
                if (this.name) {
                    param[this.name] = this.value;
                }
            });
            param.gender    = $('input[name="gender"]:checked').val();
            param.agreement = true;
            console.log(param);
            return;
            <!--{if $user}-->
            //绑定账号
            param.OPENID = <!--{$user|json_encode}-->;
            <!--{/if}-->

            <!--{if $iCMS.CONFIG.user.register.seccode }-->
            //检查验证码
            param.register_seccode = true;
            <!--{/if}-->

            // iCMS.PASSPORT.REGISTER(
            //     //提交参数
            //     param,
            //     //登录成功 事件
            //     function(ret) {
            //         window.top.location.href = ret.forward;
            //     },
            //     //登录失败 事件
            //     function(ret) {
            //         iCMS.seccode(".seccode-img","#register-box");
            //         var tip = $('.tip_'+ret[0]);
            //         tip.text(ret[1]).show();
            //         // console.log(ret);
            //     }
            // );
        });
    });
/*
    function check_form(a) {
        if (a.value == "") {
          return msg(a, 'empty');
        }
        switch (a.name) {
          case 'username':
            var pattern = /^([a-zA-Z0-9._-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9._-])+/;
            if (!pattern.test(a.value)) {
              return msg(a, "err");
            }
            ajax_check(a);
            break;
          case 'nickname':
            var length = a.value.replace(/[^\x00-\xff]/g, 'xx').length;
            if (length < 4) {
              return msg(a, "err");
            }
            if (length > 20) {
              return msg(a, "err");
            }
            ajax_check(a);
            break;
          case 'password':
            if (a.value.length < 6) {
              return msg(a, "err");
            }
            return msg(a, "ok");
            break;
          case 'rstpassword':
            var pwd = $("#iCMS-reg-password").val();
            if (pwd.length < 6) {
              return msg(a, "perr");
            }
            if (pwd != a.value) {
              return msg(a, "err");
            }
            return msg(a, "ok");
            break;
          case 'seccode':
            ajax_check(a);
            break;
        }
    }
    */
    </script>
</head>

<body class="userApp passport">
    <div class="register-wrap">
        <div class="logo"> <a href="<!--{$site.url}-->" title="<!--{$site.title}-->"><span><!--{$site.title}--></span></a>
        </div>
        <div class="passport-wrap">
            <div class="passport-main">
                <h1><!--{if $user}-->欢迎加入<!--{$site.title}--><!--{else}-->新用户注册<!--{/if}--></h1>
                <!--{if $user}-->
                <div class="alert" style="width: 500px;margin-top: 10px;margin-bottom: 5px;">
                    <strong>*</strong>请先补充必要的个人信息，只有补充完这些信息才能真正加入
                    <!--{$site.title}-->哦
                </div>
                <!--{/if}-->
                <div id="register-box" class="passport-form form-horizontal">
                    <div class="form-group">
                        <label for="username" class="control-label">电子邮箱：</label>
                        <input type="email" name="username" class="form-control" id="username" placeholder="请输入邮箱">
                        <p class="help-block err_username">请输入邮箱</p>
                    </div>
                    <div class="form-group">
                        <label for="nickname" class="control-label">昵称：</label>
                        <input type="text" name="nickname" class="form-control" id="nickname" placeholder="请输入昵称">
                        <p class="help-block err_nickname">请输入昵称</p>
                    </div>
                    <div class="radio">
                        <label class="control-label">性别：</label>
                        <label>
                            <input type="radio" name="gender" value="girl" checked="checked">女</label>
                        <label>
                            <input type="radio" name="gender" value="boy">男</label>
                    </div>
                    <div class="form-group">
                        <label for="password" class="control-label">密码：</label>
                        <input type="password" name="password" class="form-control" id="password" placeholder="请输入密码">
                    </div>
                    <div class="form-group">
                        <label for="rstpassword" class="control-label">确认密码：</label>
                        <input type="password" name="rstpassword" class="form-control" id="rstpassword" placeholder="请输入确认密码">
                    </div>
                    <!--{if $iCMS.CONFIG.user.register.seccode }-->
                    <div class="form-group">
                        <label for="seccode" class="control-label">验证码：</label>
                        <input type="text" maxlength="4" name="seccode" class="seccode form-control" id="seccode" placeholder="请输入验证码">
                        <img src="<!--{iCMS:router url='/api/public/seccode'}-->" alt="验证码" class="seccode-img r3" />
                        <a href="javascript:;" class="seccode-text" style="float: none">换一张</a>
                        <p class="help-block err_uname">请输入验证码</p>
                    </div>
                    <!--{/if}-->
                    <div class="form-group opt">
                        <label>
                            <input type="checkbox" value="1" name="agreement" class="check" checked="checked"> 我已看过并同意《
                            <a href="<!--{iCMS:router url='/api/public/agreement'}-->" target="_blank">
                                <!--{$site.title}-->网络服务使用协议</a>》
                        </label>
                    </div>
                    <div class="form-group submit">
                        <a href="javascript:;" id="register_submit" class="btn btn-success btn-lg">注 册</a>
                        <a class="findpwd" href="<!--{$iCMS.SAPI}-->&do=findpwd">忘记密码？</a>
                    </div>
                </div>
            </div>
            <div class="passport-right">
                <div class="right-wrap">
                    <h2>已经有帐号？请直接登录</h2>
                    <a class="btn btn-primary" href="<!--{iCMS:router url='/api/user/login' query=" $query "}-->">登 录</a>
                    <div class="other_login">
                        <p>您也可以用以下方式登录：</p>
                        <!--{if $iCMS.CONFIG.open.QQ.enable }-->
                        <a class="open_icon icon_qq" href="<!--{iCMS:router url='/api/user/login/qq'}-->">QQ 帐号</a>
                        <!--{/if}-->
                        <!--{if $iCMS.CONFIG.open.WB.enable }-->
                        <a class="open_icon icon_wb" href="<!--{iCMS:router url='/api/user/login/wb'}-->">新浪微博</a>
                        <!--{/if}-->
                        <!--{if $iCMS.CONFIG.open.WX.enable }-->
                        <a class="open_icon icon_wx" href="<!--{iCMS:router url='/api/user/login/wx'}-->">微信账号</a>
                        <!--{/if}-->
                    </div>
                </div>
            </div>
            <div class="clearfix"></div>
        </div>
        <!--{include file="{iTPL}/footer.htm"}-->
</body>

</html>
